logitmodelPSM<-lm(trtstatus~age+agesq+farmexp+herdsize+edu+SO_agri+mktdist+AHSdist, data=model_data)
##### Stepwise Logistic Regression #####
file_path <- "D:/Indian Veterinary Research Institute M.Sc. Agrcultural Statistics/Thesis Work/Interviews/Collapsed_CSV.csv"
goat_data <- read.csv(file_path, header = TRUE, na.strings = c("", "NA"), stringsAsFactors = FALSE)
goat_data[is.na(goat_data)] <- 0
trtstatus <- goat_data$Treatment.Status
age <- goat_data$Age..years.
agesq <- age^2
farmexp <- goat_data$Farm.Experience..Years.
goatexp <- goat_data$Experience.in.rearing.of.Goats..Years.
edu <- goat_data$No.of.Schooling.Years
gender <- goat_data$Gender
PO_agri <- goat_data$PO_Farming
PO_animal <- goat_data$PO_Goat.Farming
PO_labour <- goat_data$PO_Labour
PO_job <- goat_data$PO_Job
PO_business <- goat_data$PO_Business
PO_misc <- goat_data$PO_Misc
SO_agri <- goat_data$SO_Farming
SO_animal <- goat_data$SO_Goat.Farming
SO_labour <- goat_data$SO_Labour
SO_job <- goat_data$SO_Private.Job
SO_business <- goat_data$SO_Business
SO_misc <- goat_data$SO_Misc
NFI <- goat_data$NFI.Source...Y.N.
dwell_kuch <- goat_data$Dwelling.Structure_Kuchha
dwell_semi <- goat_data$Dwelling.Structure_Semi.Pucca
dwell_puc <- goat_data$Dwelling.Structure_Pucca
HHsize <- goat_data$Household.Size
landsize <- goat_data$Land.holding.size..Ha.
herdsize <- goat_data$Herd_Size
membership <- goat_data$Membership
mktdist <- goat_data$Mkt_Distance_KM
AHSdist <- goat_data$AHS_Distance_KM
model_data <- data.frame(trtstatus, age, agesq, farmexp, goatexp, herdsize,edu, gender, PO_agri, PO_animal, SO_agri, SO_animal, NFI, dwell_puc, dwell_semi, mktdist, AHSdist, HHsize, membership)
good_vars <- c()
##eliminating perfect separators
remove_perfect_separators <- function(data, outcome)
{
predictors <- setdiff(names(data), outcome)
for (var in predictors)
{
if (length(unique(data[[var]])) >6)
{
print(paste("Variable:", var, "- Unique values:", length(unique(data[[var]]))))
good_vars <<- c(good_vars, var)
}
else
{
tab <- table(data[[var]], data[[outcome]])
if (!any(rowSums(tab == 0) > 0))
{
good_vars <<- c(good_vars, var)
}
}
}
return(good_vars)
}
remove_perfect_separators(model_data, "trtstatus")
show(good_vars)
##### I will build formula with good_vars
formula_str <- paste("trtstatus ~", paste(good_vars, collapse = " + "))
lm_formula <- as.formula(formula_str)
lm_model <- lm(lm_formula, data = model_data)
predictions <- round(predict(lm_model, model_data))
accuracy <- mean(predictions == model_data$trtstatus)
cat("Accuracy:", accuracy, "\n")
summary(lm_model)
correct <- sum(predictions == model_data$trtstatus)
total <- length(predictions)
cat("Accuracy:", correct, "/", total, "(", round(accuracy * 100, 2), "%)\n")
####################################################### PSM  #######################################################################################################
logitmodelPSM<-lm(trtstatus~age+agesq+farmexp+herdsize+edu+SO_agri+mktdist+AHSdist, data=model_data)
PSMtrial1<-matchit(logitmodelPSM, data= model_data, method= "nearest",ratio=1)
library(MatchIt)
logitmodelPSM<-lm(trtstatus~age+agesq+farmexp+herdsize+edu+SO_agri+mktdist+AHSdist, data=model_data)
PSMtrial1<-matchit(logitmodelPSM, data= model_data, method= "nearest",ratio=1)
PSMtrial1<-matchit(trtstatus~age+agesq+farmexp+herdsize+edu+SO_agri+mktdist+AHSdist, data= model_data, method= "nearest",ratio=1)
summary(PSMtrial1)
####################################################### PSM  #######################################################################################################
library(MatchIt)
Lm1PSM<-lm(trtstatus~age+agesq+farmexp+herdsize+edu+SO_agri+mktdist+AHSdist, data=model_data)
Lm1PSM$fitted.values
Lm1PSM<-lm(trtstatus~age+agesq+farmexp+herdsize+edu+SO_agri+mktdist+AHSdist, data=model_data)
Lm1PSM$fitted.values
raw_fitted <- Lm1PSM$fitted.values
propensity_scores <- 1 / (1 + 2.71828^(-raw_fitted))
propensity_df <- data.frame(Propensity_Score = propensity_scores)
head(propensity_df)
show(propensity_df)
Lm1PSM <- glm(trtstatus ~ age + agesq + farmexp + herdsize + edu + SO_agri + mktdist + AHSdist,
data = model_data,
family = binomial)
propensity_df <- data.frame(Propensity_Score = Lm1PSM$fitted.values)
show(propensity_df)
plot(propensity_df)
plot(propensity_scores)
library(ggplot2)
geom_histogram(propensity_scores)
geom_histogram(propensity_scores)
hist(propensity_scores)
model_data$pscore <- propensity_score
model_data$pscore <- propensity_scores
# Matching using your precomputed scores
match_result <- matchit(
trtstatus ~ pscore,                # use pscore as the only "predictor"
data = model_data,
method = "nearest",                # nearest neighbor matching
distance = model_data$pscore,      # supply the actual scores
ratio = 1                          # 1:1 matching
)
# View results
summary(match_result)
# Extract matched dataset
matched_data <- match.data(match_result)
show(matched_data)
# View results
summary(match_result)
# Matching using your precomputed scores
match_result <- matchit(
trtstatus ~ pscore,                # use pscore as the only "predictor"
data = model_data,
method = "nearest",                # nearest neighbor matching
distance = model_data$pscore,      # supply the actual scores
ratio = 2                          # 1:1 matching
)
# View results
summary(match_result)
# Extract matched dataset
matched_data <- match.data(match_result)
show(matched_data)
match_result <- matchit(
trtstatus ~ pscore,                # use pscore as the only "predictor"
data = model_data,
method = "kernel",                # nearest neighbor matching
distance = model_data$pscore,      # supply the actual scores
ratio = 2                          # 1:1 matching
)
match_result <- matchit(
trtstatus ~ pscore,                # use pscore as the only "predictor"
data = model_data,
method = "kernel",                # nearest neighbor matching
distance = model_data$pscore,      # supply the actual scores
ratio = 1                         # 1:1 matching
)
library(MatchIt)
HDDS_PSM<-read.csv("C:\\Users\\ATTISO\\Downloads\\Central_zone_HDDS.csv", header= TRUE)
install.packages("MatchIt")
library(MatchIt)
HDDS_PSM<-read.csv("G:/Downloads/Central_zone_HDDS.csv", header= TRUE)
str(HDDS_PSM)
b<-HDDS_PSM$Beneficary.Non.Beneficary
a<-HDDS_PSM$Age
l<-HDDS_PSM$Landholding
PSMtrial1<-matchit(b~a+l, data= HDDS_PSM, method= "nearest",ratio=1)
summary(PSMtrial1)
plot(PSMtrial1, type= "hist")
PSMtrial1$match.matrix
summary(PSMtrial1)
PSMtrial1$match.matrix
Lm1PSM<-lm(trtstatus~age+agesq+farmexp+herdsize+edu+SO_agri+mktdist+AHSdist, data=model_data)
summary(Lm1PSM)
PSMmatch<-matchit(trtstatus~age+agesq+farmexp+herdsize+edu+SO_agri+mktdist+AHSdist, data=model_data, method= "nearest",ratio=1)
summary(PSMmatch)
PSMmatch$match.matrix
PSMtrial1$match.matrix
summary(PSMtrial1)
summary(PSMmatch)
library(MatchIt)
PSMmatch <- matchit(
trtstatus ~ age + agesq + farmexp + herdsize + edu + SO_agri + mktdist + AHSdist,
data = model_data,
method = "nearest",
distance = "logit",  # Force standard logistic estimation
ratio = 1
)
# View results
summary(PSMmatch)
##### Step 0 – Prepare data #####
# Assuming 'model_data' is already loaded from Collapsed_CSV.csv
# Replace NA with 0 (as per your workflow)
model_data[is.na(model_data)] <- 0
##### Step 1 – Logistic regression with all candidate variables #####
full_model <- glm(
trtstatus ~ age + agesq + farmexp + herdsize + edu + SO_agri + mktdist + AHSdist,
data = model_data,
family = binomial
)
##### Step 2 – Extract significant variables (p < 0.05) #####
sig_vars <- names(coef(full_model))[which(summary(full_model)$coefficients[, 4] < 0.05)]
sig_vars <- setdiff(sig_vars, "(Intercept)")  # remove intercept
if (length(sig_vars) == 0) {
stop("No significant predictors found. Try relaxing p-value threshold.")
}
##### Step 0 – Prepare data #####
# Assuming 'model_data' is already loaded from Collapsed_CSV.csv
# Replace NA with 0 (as per your workflow)
model_data[is.na(model_data)] <- 0
##### Step 1 – Logistic regression with all candidate variables #####
full_model <- glm(
trtstatus ~ age + agesq + farmexp + herdsize + edu + SO_agri + mktdist + AHSdist,
data = model_data,
family = binomial
)
##### Step 2 – Extract significant variables (p < 0.05) #####
sig_vars <- names(coef(full_model))[which(summary(full_model)$coefficients[, 4] < 0.05)]
sig_vars <- setdiff(sig_vars, "(Intercept)")  # remove intercept
if (length(sig_vars) == 0) {
stop("No significant predictorAttisos found. Try relaxing p-value threshold.")
}
logit<-glm(trtstatus ~ age + agesq + farmexp + herdsize + edu + SO_agri + mktdist + AHSdist,
data = goat_data,family=binomial)
logit<-glm(trtstatus ~ age + agesq + farmexp + herdsize + edu + mktdist + AHSdist,
data = goat_data,family=binomial)
logit<-glm(trtstatus ~ age + agesq + farmexp + herdsize + edu + SO_agri + mktdist + AHSdist,
data = goat_data,family="binomial")
b<-HDDS_data$Beneficary.Non.Beneficary
HDDS_data<-read.csv("G:/Downloads/Central_zone_HDDS.csv", header= TRUE)
b<-HDDS_data$Beneficary.Non.Beneficary
e<-HDDS_data$Education
l<-HDDS_data$Landholding
a<-HDDS_data$Age
t<-HDDS_data$TLU
logisticmodel<-glm(b~e+l+a+t, HDDS_data,family="binomial")
summary(logisticmodel)
##### Stepwise Logistic Regression #####
file_path <- "D:/Indian Veterinary Research Institute M.Sc. Agrcultural Statistics/Thesis Work/Interviews/Collapsed_CSV.csv"
goat_data <- read.csv(file_path, header = TRUE)
goat_data[is.na(goat_data)] <- 0
trtstatus <- goat_data$Treatment.Status
age <- goat_data$Age..years.
agesq <- age^2
farmexp <- goat_data$Farm.Experience..Years.
goatexp <- goat_data$Experience.in.rearing.of.Goats..Years.
edu <- goat_data$No.of.Schooling.Years
gender <- goat_data$Gender
PO_agri <- goat_data$PO_Farming
PO_animal <- goat_data$PO_Goat.Farming
PO_labour <- goat_data$PO_Labour
PO_job <- goat_data$PO_Job
PO_business <- goat_data$PO_Business
SO_agri <- goat_data$SO_Farming
SO_animal <- goat_data$SO_Goat.Farming
SO_labour <- goat_data$SO_Labour
SO_job <- goat_data$SO_Private.Job
SO_business <- goat_data$SO_Business
logit<-glm(trtstatus ~ age + farmexp + herdsize + edu + SO_agri + mktdist + AHSdist,
goat_data,family="binomial")
logit$fitted.values
logit<-glm(trtstatus ~ age + farmexp + herdsize + edu + SO_agri + mktdist + AHSdist,
goat_data,family="binomial")
logAttiso<-glm(trtstatus ~ age + farmexp + herdsize + edu + SO_agri + mktdist + AHSdist,
goat_data,family="binomial")
summary(logAttiso)
HDDS_data<-read.csv("G:/Downloads/Central_zone_HDDS.csv", header= TRUE)
b<-HDDS_data$Beneficary.Non.Beneficary
e<-HDDS_data$Education
l<-HDDS_data$Landholding
a<-HDDS_data$Age
t<-HDDS_data$TLU
logisticmodel<-glm(b~e+l+a+t, HDDS_data,family="binomial")
summary(logisticmodel)
library(MatchIt)
#PSM here
PSMmatch <- matchit(
trtstatus ~ age + agesq + farmexp + herdsize + edu + SO_agri + mktdist + AHSdist,
data = goat_data,
method = "nearest",
distance = "logit",  # Force standard logistic estimation
ratio = 1
)
# View results
summary(PSMmatch)
goat_data[is.na(goat_data)] <- 0
goat_data
data <- read.csv(file.choose(), header = T)
goat_data[is.na(goat_data)] <- 0
trtstatus <- goat_data$Treatment.Status
age <- goat_data$Age..years.
agesq <- age^2
farmexp <- goat_data$Farm.Experience..Years.
goatexp <- goat_data$Experience.in.rearing.of.Goats..Years.
edu <- goat_data$No.of.Schooling.Years
gender <- goat_data$Gender
PO_agri <- goat_data$PO_Farming
PO_animal <- goat_data$PO_Goat.Farming
PO_labour <- goat_data$PO_Labour
PO_job <- goat_data$PO_Job
PO_business <- goat_data$PO_Business
SO_agri <- goat_data$SO_Farming
SO_animal <- goat_data$SO_Goat.Farming
SO_labour <- goat_data$SO_Labour
SO_job <- goat_data$SO_Private.Job
SO_business <- goat_data$SO_Business
logAttiso<-glm(trtstatus ~ age + farmexp + herdsize + edu + SO_agri + mktdist + AHSdist,
goat_data,family="binomial")
summary(logAttiso)
#file_path <- "D:/Indian Veterinary Research Institute M.Sc. Agrcultural Statistics/Thesis Work/Interviews/Collapsed_CSV.csv"
goat_data <- read.csv(file_path, header = TRUE)
#file_path <- "D:/Indian Veterinary Research Institute M.Sc. Agrcultural Statistics/Thesis Work/Interviews/Collapsed_CSV.csv"
goat_data <- read.csv(file.choose(), header = TRUE)
goat_data[is.na(goat_data)] <- 0
trtstatus <- goat_data$Treatment.Status
age <- goat_data$Age..years.
agesq <- age^2
farmexp <- goat_data$Farm.Experience..Years.
goatexp <- goat_data$Experience.in.rearing.of.Goats..Years.
edu <- goat_data$No.of.Schooling.Years
gender <- goat_data$Gender
PO_agri <- goat_data$PO_Farming
PO_animal <- goat_data$PO_Goat.Farming
PO_labour <- goat_data$PO_Labour
PO_job <- goat_data$PO_Job
PO_business <- goat_data$PO_Business
SO_agri <- goat_data$SO_Farming
SO_animal <- goat_data$SO_Goat.Farming
SO_labour <- goat_data$SO_Labour
SO_job <- goat_data$SO_Private.Job
SO_business <- goat_data$SO_Business
logAttiso<-glm(trtstatus ~ age + farmexp + herdsize + edu + SO_agri + mktdist + AHSdist + gender,
goat_data,family="binomial")
summary(logAttiso)
fitted(logAttiso)
#file_path <- "D:/Indian Veterinary Research Institute M.Sc. Agrcultural Statistics/Thesis Work/Interviews/Collapsed_CSV.csv"
goat_data <- read.csv(file.choose(), header = TRUE)
goat_data[is.na(goat_data)] <- 0
trtstatus <- goat_data$Treatment.Status
age <- goat_data$Age..years.
agesq <- age^2
farmexp <- goat_data$Farm.Experience..Years.
goatexp <- goat_data$Experience.in.rearing.of.Goats..Years.
edu <- goat_data$No.of.Schooling.Years
gender <- goat_data$Gender
PO_agri <- goat_data$PO_Farming
PO_animal <- goat_data$PO_Goat.Farming
PO_labour <- goat_data$PO_Labour
PO_job <- goat_data$PO_Job
PO_business <- goat_data$PO_Business
SO_agri <- goat_data$SO_Farming
SO_animal <- goat_data$SO_Goat.Farming
SO_labour <- goat_data$SO_Labour
SO_job <- goat_data$SO_Private.Job
SO_business <- goat_data$SO_Business
logAttiso<-glm(trtstatus ~ age + farmexp + herdsize + edu + SO_agri + mktdist + AHSdist + gender,
goat_data,family="binomial")
logAttiso<-glm(trtstatus ~ age + farmexp + edu + SO_agri + mktdist + AHSdist + gender,
goat_data,family="binomial")
goat_data[is.na(goat_data)] <- 0
goat_data
logAttiso<-glm(trtstatus ~ age + farmexp + edu + SO_agri + mktdist + AHSdist + gender,
goat_data,family="binomial")
goat_data
#file_path <- "D:/Indian Veterinary Research Institute M.Sc. Agrcultural Statistics/Thesis Work/Interviews/Collapsed_CSV.csv"
goat_data <- read.csv(file.choose(), header = TRUE)
goat_data[is.na(goat_data)] <- 0
goat_data
trtstatus <- goat_data$Treatment.Status
age <- goat_data$Age..years.
agesq <- age^2
farmexp <- goat_data$Farm.Experience..Years.
goatexp <- goat_data$Experience.in.rearing.of.Goats..Years.
edu <- goat_data$No.of.Schooling.Years
gender <- goat_data$Gender
PO_agri <- goat_data$PO_Farming
PO_animal <- goat_data$PO_Goat.Farming
PO_labour <- goat_data$PO_Labour
PO_job <- goat_data$PO_Job
PO_business <- goat_data$PO_Business
SO_agri <- goat_data$SO_Farming
SO_animal <- goat_data$SO_Goat.Farming
SO_labour <- goat_data$SO_Labour
SO_job <- goat_data$SO_Private.Job
SO_business <- goat_data$SO_Business
logAttiso<-glm(trtstatus ~ age + farmexp + edu +
SO_agri + mktdist + AHSdist + gender,
goat_data,family="binomial")
mktdist<-goat_data$Mkt_Distance_KM
logAttiso<-glm(trtstatus ~ age + farmexp + edu +
SO_agri + mktdist + AHSdist + gender,
goat_data,family="binomial")
AHSdist<-goat_data$AHS_Distance_KM
logAttiso<-glm(trtstatus ~ age + farmexp + edu +
SO_agri + mktdist + AHSdist + gender,
goat_data,family="binomial")
fitted(logAttiso)
summary(logAttiso)
logAttiso<-glm(trtstatus ~ age + farmexp + edu +
SO_agri + mktdist + AHSdist + gender,
goat_data,family="binomial", model = "logit")
summary(logAttiso)
logAttiso<-glm(trtstatus ~ age + farmexp + edu +
SO_agri + mktdist + AHSdist,
goat_data,family="binomial", model = "logit")
summary(logAttiso)
logAttiso<-glm(trtstatus ~ age + farmexp + edu +
SO_agri + mktdist + AHSdist,
goat_data,family="binomial", model = "logit")
summary(logAttiso)
logAttiso<-glm(trtstatus ~ age + farmexp + edu +
SO_agri + mktdist + AHSdist,
goat_data,family="binomial", model = "logit")
summary(logAttiso)
